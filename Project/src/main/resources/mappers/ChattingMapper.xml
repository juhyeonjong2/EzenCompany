<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
			"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ezen.ezencompany.mapper.chattingMapper">

	<select id="chattingList" resultType="attributeVO">
		select value, aidx from attribute where cidx=1;
	</select>
	
	<select id="detaleList" resultType="MemberVO">
		select distinct m.mno, aidx, m.mname from member m inner join employeeoption e on m.mno = e.mno where cidx = 1;
	</select>
	
	<select id="getRoom" parameterType="java.util.Map" resultType="String">
		select distinct b.chattingRoom from chatting a inner join chatting b 
			on a.chattingRoom = b.chattingRoom where a.mno = #{anotherMno} and b.mno = #{myMno};
	</select>
	
	<select id="chattingStart" parameterType="String" resultType="chatVO">
		SELECT distinct a.cindex, a.chat, a.mno, a.cdate FROM chatting a inner join chatting b 
		   on a.chattingRoom = b.chattingRoom 
		     WHERE a.chattingRoom = #{chattingroom} order by a.cindex;
	</select>
	
	<insert id="chattingCreate" parameterType="java.util.Map">
		INSERT INTO chatting (chattingRoom, cdate, mno) VALUES
		    (#{uuid}, now(), #{myMno}),
		    (#{uuid}, now(), #{anotherMno});
	</insert>
	
	<select id="getProfile" parameterType="int" resultType="String">
		SELECT mfrealname FROM memberattach WHERE mno = #{anotherMno};
	</select>
	
	<insert id="chatting" parameterType="java.util.Map">
		INSERT INTO chatting (chattingRoom, cdate, mno, chat) VALUES
		    (#{chattingroom}, now(), #{myMno}, #{chat});
	</insert>
</mapper>